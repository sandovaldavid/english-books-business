---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

// Update the Props interface to include new SEO fields
interface Props {
	title: string;
	description: string;
	image?: string;
	canonicalURL?: string;
	ogType?: string;
	ogTitle?: string;
	ogDescription?: string;
	ogImage?: string;
	ogSiteName?: string;
	twitterCard?: string;
	twitterTitle?: string;
	twitterDescription?: string;
	twitterImage?: string;
	twitterSite?: string;
	language?: string;
}

const {
	title,
	description,
	image,
	canonicalURL = Astro.url.href,
	ogType = 'website',
	ogTitle = title,
	ogDescription = description,
	ogImage = image,
	ogSiteName = 'FluentReads',
	twitterCard = 'summary_large_image',
	twitterTitle = title,
	twitterDescription = description,
	twitterImage = image,
	twitterSite = '@fluentreads',
	language = 'es',
} = Astro.props;

// Format image URL properly if it's a relative path
const formattedImage =
	typeof image === 'string' && image?.startsWith('/')
		? new URL(image, Astro.url.origin).toString()
		: image;
---

<!doctype html>
<html lang={language}>
	<head>
		<meta charset='utf-8' />
		<meta name='viewport' content='width=device-width' />
		<title>{title}</title>
		<meta name='description' content={description} />

		<!-- Favicon -->
		<link rel='icon' type='image/svg+xml' href='/favicon.svg' />

		<!-- Canonical URL -->
		<link rel='canonical' href={canonicalURL} />

		<!-- Open Graph / Facebook -->
		<meta property='og:type' content={ogType} />
		<meta property='og:url' content={canonicalURL} />
		<meta property='og:title' content={ogTitle} />
		<meta property='og:description' content={ogDescription} />
		{ogImage && <meta property='og:image' content={ogImage} />}
		<meta property='og:site_name' content={ogSiteName} />

		<!-- Twitter -->
		<meta name='twitter:card' content={twitterCard} />
		<meta name='twitter:title' content={twitterTitle} />
		<meta name='twitter:description' content={twitterDescription} />
		{twitterImage && <meta name='twitter:image' content={twitterImage} />}
		{twitterSite && <meta name='twitter:site' content={twitterSite} />}

		<!-- Additional SEO tags for language learning books -->
		<meta
			name='keywords'
			content='libros en inglés, aprender inglés, material educativo, inglés para negocios, FluentReads, libros para profesionales'
		/>
		<meta name='robots' content='index, follow' />
		<meta name='language' content={language} />
		<meta name='revisit-after' content='7 days' />

		<!-- Additional head elements -->
		<slot name='head' />

		<!-- Fonts -->
		<link rel='preconnect' href='https://fonts.googleapis.com' />
		<link rel='preconnect' href='https://fonts.gstatic.com' crossorigin />
		<link
			href='https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap'
			rel='stylesheet'
		/>
		<link
			href='https://fonts.googleapis.com/css2?family=Lora:ital,wght@1,600&display=swap'
			rel='stylesheet'
		/>

		<link
			rel='stylesheet'
			href='https://s.pageclip.co/v1/pageclip.css'
			media='screen'
		/>

		<!-- Lite YouTube custom element -->
		<script>
			import('@justinribeiro/lite-youtube');
		</script>
	</head>
	<body class='font-poppins'>
		<Header />
		<main>
			<slot />
		</main>
		<Footer />
		<!-- Add Pageclip script -->
		<script src='https://s.pageclip.co/v1/pageclip.js' charset='utf-8'
		></script>
	</body>
</html>
